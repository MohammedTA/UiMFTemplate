<div class="input-group">
	<span class="input-group-addon">Min</span>
	<input type="text"
		bind:value="field.minValueAsText"
		required="{field.metadata.required}"
		tabindex="{tabindex}"
		autocomplete="off"
		class="form-control"
		ref:minContainer>

    <span class="input-group-addon">Max</span>
	<input type="text"
		bind:value="field.maxValueAsText"
		required="{field.metadata.required}"
		tabindex="{tabindex}"
		autocomplete="off"
		class="form-control"
		ref:maxContainer>
</div>

<script>
	import Pikaday from "pikaday-time";

	export default {
		oncreate() {
			const { field } = this.get();
			const includeTime = field.metadata.getCustomProperty("includeTime") || false;

			// eslint-disable-next-line no-new
			new Pikaday({
				field: this.refs.minContainer,
				format: includeTime ? "YYYY-MM-DD hh:mm A" : "YYYY-MM-DD",
				showTime: includeTime,
				showMinutes: true,
				showSeconds: false,
				use24hour: false,
				incrementHourBy: 1,
				incrementMinuteBy: 5,
				incrementSecondBy: 1,
				i18n: {
					midnight: "0 AM", // Label for 0 AM
					noon: "12 AM", // Label for 12 AM
					previousMonth: "Previous Month",
					nextMonth: "Next Month",
					months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
					weekdays: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
					weekdaysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
				},
				timeLabel: "الوقت", // optional string added to left of time select
				onSelect(date) {
					field.value.min = date;
				}
			});

			// eslint-disable-next-line no-new
			new Pikaday({
				field: this.refs.maxContainer,
				format: includeTime ? "YYYY-MM-DD hh:mm A" : "YYYY-MM-DD",
				showTime: includeTime,
				showMinutes: true,
				showSeconds: false,
				use24hour: false,
				incrementHourBy: 1,
				incrementMinuteBy: 5,
				incrementSecondBy: 1,
				i18n: {
					midnight: "0 AM", // Label for 0 AM
					noon: "12 AM", // Label for 12 AM
					previousMonth: "Previous Month",
					nextMonth: "Next Month",
					months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
					weekdays: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
					weekdaysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]
				},
				onSelect(date) {
					field.value.max = date;
				}
			});

			const minElement = this.refs.minContainer;
			minElement.addEventListener("change", () => {
				if (minElement.value === "") {
					field.value.min = null;
				}
			});

			const maxElement = this.refs.maxContainer;
			maxElement.addEventListener("change", () => {
				if (maxElement.value === "") {
					field.value.max = null;
				}
			});
		}
	};
</script>

<style>
		.input-group-addon {
			font-size: 0.8rem !important;
		}
</style>
